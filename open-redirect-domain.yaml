id: open-redirect-domain

info:
  name: Open Redirect Parameter Detection Template
  author: rix4uni
  severity: low
  description: An open redirect vulnerability was detected. An attacker can redirect a user to a malicious site and possibly obtain sensitive information, modify data, and/or execute unauthorized operations.
  reference: https://tools.intigriti.io/redirector/#
  tags: redirect,open-redirect-domain

requests:
  - method: GET
    path:
      # basic payloads
      - '{{BaseURL}}.evil.com'
      - '{{BaseURL}}//evil.com'
      - '{{BaseURL}}///evil.com'
      # Double Encoding
      - '{{BaseURL}}%2f@evil.com'
      - '{{BaseURL}}%252f@evil.com'
      - '{{BaseURL}}%25252f@evil.com'
      # Non-ASCII Characters
      - '{{BaseURL}}?.evil.com'
      - '{{BaseURL}}â•±.evil.com'

    matchers:
      - type: word
        words:
          - 'evil.com'

      - type: status
        status:
          - 301
          - 302
          - 303
          - 307
          - 308