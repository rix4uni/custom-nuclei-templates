id: generic-api-tokens

info:
  name: Generic Api & Tokens Detection
  author: rix4uni
  severity: info
  metadata:
    verified: "true"
  tags: github,token,exposure

requests:
  - method: GET
    path:
      - "{{BaseURL}}"

    extractors:
      - type: regex
        part: body
        regex:
          - '\b(ghp_[a-zA-Z0-9]{36})\b' #github-personal-access
          - '\b((?:ghu|ghs)_[a-zA-Z0-9]{36})\b' #github-app
          - '\b(gho_[a-zA-Z0-9]{36})\b' #github-oauth-access
          - '\b(ghr_[a-zA-Z0-9]{76})\b' #github-refresh
          - '(?i)\b(p8e-[a-z0-9-]{32})(?:[^a-z0-9-]|$)' #adobe-oauth-secret
          - '\bage1[0-9a-z]{58}\b'  #age-public-key
          - '\bAGE-SECRET-KEY-1[0-9A-Z]{58}\b'  #age-secret-key
          - "amzn\\.mws\\.[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}" #amazon-mws-auth-token
          - 'arn:aws:sns:[a-z0-9\-]+:[0-9]+:[A-Za-z0-9\-_]+'  #amazon-sns-topic
          - "(A3T[A-Z0-9]|AKIA|AGPA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}"  #aws-access-key-value
          - '(?i)aws_?(?:account)_?(?:id)?["''`]?\s{0,30}(?::|=>|=)\s{0,30}["''`]?([0-9]{4}-?[0-9]{4}-?[0-9]{4})' #aws-account-id
          - '\b((?:A3T[A-Z0-9]|AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16})\b' #aws-api-key
          - '(?i)(?:aws.?session|aws.?session.?token|aws.?token)["''`]?\s{0,30}(?::|=>|=)\s{0,30}["''`]?([a-z0-9/+=]{16,200})[^a-z0-9/+=]'  #aws-session-token
          - '(?:\s|=|:|"|^)AP[\dABCDEF][a-zA-Z0-9]{8,}' #artifactory-api-password
          - '(?:\s|=|:|"|^)AKC[a-zA-Z0-9]{10,}' #artifactory-api-token
          - 'R_[0-9a-f]{32}'  #bitly-secret-key
          - 'cloudinary://[0-9]+:[A-Za-z0-9\-_\.]+@[A-Za-z0-9\-_\.]+' #cloudinary-credentials
          - '(?i)codeclima.{0,50}\b([a-f0-9]{64})\b'  #codeclimate-token
          - '\bcio[a-zA-Z0-9]{32}\b'  #crates-api-key
          - 'https://discordapp\.com/api/webhooks/[0-9]+/[A-Za-z0-9\-]+'  #discord-webhook
          - '\b(dt0[a-zA-Z]{1}[0-9]{2}\.[A-Z0-9]{24}\.[A-Z0-9]{64})\b'  #dynatrace-api-token
          - '\b(EAACEdEose0cBA[a-zA-Z0-9]+)\b'  #facebook-access-token
          - 'jdbc:[a-z:]+://[A-Za-z0-9\.\-_:;=/@?,&]+'  #jdbc-connection-string
          - 'eyJ[a-zA-Z0-9]{10,}\.eyJ[a-zA-Z0-9]{10,}\.[a-zA-Z0-9_\-]{10,}' #jwt-token
          - '\b(GR1348941[0-9a-zA-Z_-]{20})(?:\b|$)'  #gitlab-runner-token
          - '\b(glpat-[0-9a-zA-Z_-]{20})(?:\b|$)' #gitlab-personal-token
          - '\b(glptt-[0-9a-f]{40})\b'  #gitlab-pipeline-token
          - 'ya29\.[0-9A-Za-z\-_]+' #google-oauth-access-key
          - "AAAA[a-zA-Z0-9_-]{7}:[a-zA-Z0-9_-]{140}" #fcm-server-key
          - "AIza[0-9A-Za-z\\-_]{35}" #google-api-key
          - 'https://www\.google\.com/calendar/embed\?src=[A-Za-z0-9%@&;=\-_\./]+'  #google-calendar-link
          - '(?i)\b([0-9]+-[a-z0-9_]{32})\.apps\.googleusercontent\.com'  #google-client-id
          - '(GOCSPX-[a-zA-Z0-9_-]{28})'  #google-oauth-prefixed
          - '(?i)heroku.{0,20}key.{0,20}\b([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})\b' #heroku-api-key
          - '(?i)jenkins.{0,10}(?:crumb)?.{0,10}\b([0-9a-f]{32,36})\b'  #jenkins-crumb-token
          - "[A-Z]{2}[0-9]{2}-[A-Z]{2}[0-9]{2}-[A-Z]{2}[0-9]{2}-[A-Z]{2}[0-9]{2}" #loqate-api-key
          - "[0-9a-f]{32}-us[0-9]{1,2}" #mailchimp-access-key-value
          - '(?i)(?:mailgun|mg).{0,20}key-([a-z0-9]{32})\b' #mailgun-api-token
          - 'sk\.eyJ1Ijoi\w+\.[\w-]*' #mapbox-token-disclosure
          - 'https://outlook\.office\.com/webhook/[A-Za-z0-9\-@]+/IncomingWebhook/[A-Za-z0-9\-]+/[A-Za-z0-9\-]+'  #microsoft-teams-webhook
          - '(?i)NRSP-[a-z]{2}[0-9]{2}[a-f0-9]{31}' #newrelic-synthetics-location-key
          - '(?i)NRAA-[a-f0-9]{27}' #newrelic-admin-api-key
          - '(?i)NRI(?:I|Q)-[A-Za-z0-9\-_]{32}' #newrelic-insights-key
          - "(px-api-[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12})" #newrelic-pixie-api-key
          - "(px-dep-[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12})" #newrelic-pixie-deploy-key
          - '(?i)NRRA-[a-f0-9]{42}' #newrelic-rest-api-key
          - "(npm_[A-Za-z0-9]{36})" #npm-access-token
          - "(oy2[a-z0-9]{43})" #nuget-api-key
          - "(sk-[a-zA-Z0-9]{48})"  #openai-api-key
          - 'access_token\$production\$[0-9a-z]{16}\$[0-9a-f]{32}'  #braintree-access-token
          - 'sk_live_[0-9a-z]{32}'  #picatic-api-key
          - "(pypi-AgEIcHlwaS5vcmc[a-zA-Z0-9_-]{50,})"  #pypi-upload-token
          - "rzp_(live|test)_.{14}" #razorpay-clientid-disclosure
          - "(rubygems_[a-f0-9]{48})" #rubygems-api-key
          - '(?i)sauce.{0,50}\b([a-f0-9-]{36})\b' #sauce-token
          - '(sgp_[a-zA-Z0-9]{64})' #segment-public-token
          - 'SG\.[a-zA-Z0-9-_]{22}\.[a-zA-Z0-9_-]{43}'  #sendgrid-api-key
          - '\b(shpat_[a-fA-F0-9]{32})\b' #shopify-public-token
          - '\b(shpss_[a-fA-F0-9]{32})\b' #shopify-app-secret
          - '\b(shpca_[a-fA-F0-9]{32})\b' #shopify-customapp-token
          - '\b(shppa_[a-fA-F0-9]{32})\b' #shopify-legacy-token
          - "https://hooks\\.slack\\.com/services/T[a-zA-Z0-9_]{8}/B[a-zA-Z0-9_]{8}/[a-zA-Z0-9_]{24}" #slack-webhook-token
          - "xoxb-[0-9A-Za-z\\-]{51}" #slack-bot-token
          - "xoxp-[0-9A-Za-z\\-]{72}" #slack-user-token
          - "sonar.{0,50}(?:\"|'|`)?[0-9a-f]{40}(?:\"|'|`)?"  #sonarqube-token
          - '(?i)\b(sq0csp-[a-z0-9_-]{43})\b' #square-oauth-secret-token
          - '(?i)\b(sq0atp-[a-z0-9_-]{22})\b' #square-access
          - '\b(hawk\.[0-9A-Za-z_-]{20}\.[0-9A-Za-z_-]{20})\b'  #stackhawk-api
          - 'sk_(?:live|test)_[0-9a-zA-Z]{24}'  #stripe-secret-key
          - 'rk_(?:live|test)_[0-9a-zA-Z]{24}'  #stripe-restricted-key
          - '\b(\d+:AA[a-zA-Z0-9_-]{32,33})'  #telegram-bot-token
          - '(?i)twilio.{0,20}\b(sk[a-f0-9]{32})\b' #twilio-api-key
          - 'https://(?:www.)?hooks\.zapier\.com/hooks/catch/[A-Za-z0-9]+/[A-Za-z0-9]+/'  #zapier-webhook-token
          - 'https://creator\.zoho\.com/api/[A-Za-z0-9/\-_\.]+\?authtoken=[A-Za-z0-9]+' #zoho-webhook-token
          - '\b(sk[a-zA-Z0-9]{178})\b'  #sanity_api_token
          - '\b([a-zA-Z0-9]{32})\b' #possible algolia-api-key,trello_api,1forge-api-key,abstractapi
          - '\b([a-zA-Z0-9]{40})\b' #possible xsolla-api-key
          - '\b(skey_test_[a-zA-Z0-9]{19})\b' #omise-secret-key
          - '\b([a-zA-Z0-9]{64})\b' #possible trello_token,alienvault-api,binance-api
          - '\b([a-zA-Z0-9]{80})\b' #possible abuseipdb-api
          - '\b([a-zA-Z0-9]{33})\b' #possible adoptapet-api
          - '\b([a-zA-Z0-9]{14})\b' #possible airtable-api
          - '\b([a-zA-Z0-9]{30})\b' #possible amdoren-api
          - '\b([a-zA-Z0-9]{43})\b' #possible bitcoinaverage-api
          - '\b([a-zA-Z0-9]{86})\b' #possible bitrise-api
          - '\b([a-zA-Z0-9-_.~]{35,48})\b'  #possible blitapp-api
          - '\b([a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4})\b' #possible block.io-api
          - '\b([a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[0-9a-f]{12})\b'  #possible api.blockchain.com-api
          - '\b(mainnet[a-zA-Z0-9]{32})\b'  #possible blockfrost-mainnet-api
          - '\b(testnet[a-zA-Z0-9]{32})\b'  #possible blockfrost-testnet-api
          - '\b(ipfs[a-zA-Z0-9]{32})\b'  #possible blockfrost-ipfs-api
          - '\b([a-zA-Z0-9]{50})\b'  #possible bravenewcoin-api
          - '\b(sl.[a-zA-Z0-9-_]{136})\b' #dropbox-api