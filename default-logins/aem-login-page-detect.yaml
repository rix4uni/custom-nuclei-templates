id: aem-login-page-detect

info:
  name: Adobe AEM Login Page - Detect
  author: rix4uni
  severity: high
  description: Multiple Adobe AEM login page detected.
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:L
    cvss-score: 8.3
    cwe-id: CWE-522
  reference:
    - https://github.com/0ang3el/aem-hacker/blob/master/aem_hacker.py
    - https://github.com/projectdiscovery/nuclei-templates/blob/main/default-logins/aem/aem-default-login.yaml
    - https://experienceleague.adobe.com/docs/experience-manager-64/administering/security/security-checklist.html?lang=en
  metadata:
    shodan-query:
      - http.title:"AEM Sign In"
      - http.component:"Adobe Experience Manager"
      - http.favicon.hash:-144483185
  tags: default-login,misconfig,aem,adobe

requests:
  - method: GET
    path:
      - "{{BaseURL}}/libs/granite/core/content/login.html"
      - "{{BaseURL}}/libs/granite/core/content/audi/login.html"

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<title>Adobe Experience Manager Web Console - Bundles</title>"
          - "<title>AEM Sign In</title>"
          - "AEM Sign In</title>"
        condition: or

      - type: status
        status:
          - 200