id: open-redirect-parameter

info:
  name: Open Redirect Parameter Detection Template
  author: rix4uni
  severity: low
  description: An open redirect vulnerability was detected. An attacker can redirect a user to a malicious site and possibly obtain sensitive information, modify data, and/or execute unauthorized operations.
  reference: https://tools.intigriti.io/redirector/#
  tags: redirect,open-redirect-parameter

requests:
  - method: GET
    path:
      # basic payloads
      - '{{BaseURL}}https:/evil.com'
      - '{{BaseURL}}https://evil.com'
      - '{{BaseURL}}http:/\/\evil.com'
      - '{{BaseURL}}https:/\evil.com'
      - '{{BaseURL}}#evil.com'
      - '{{BaseURL}}#%20@evil.com'
      - '{{BaseURL}}/evil.com'
      # URL encoding
      - '{{BaseURL}}%2Fevil.com'
      - '{{BaseURL}}%2F%2Fevil.com'
      - '{{BaseURL}}https%3A%2F%2Fevil.com'
      # CRLF
      - '{{BaseURL}}%0D%0A/evil.com'
      # "https:" to bypass "//" blacklisted keyword
      - '{{BaseURL}}https:evil.com'
      # "\/" to bypass "//" blacklisted keyword
      - '{{BaseURL}}\/\/evil.com/'
      - '{{BaseURL}}/\/evil.com/'
      # "@" character, browser will redirect to anything after the "@"
      - '{{BaseURL}}@evil.com'
      # "//" to bypass "http" blacklisted keyword
      - '{{BaseURL}}//evil.com'
      # null byte %00 to bypass blacklist filter
      - '{{BaseURL}}evil%00.com'
      # '%E3%80%82' or '。' to bypass '.' blacklisted character
      - '{{BaseURL}}evil%E3%80%82com'
      - '{{BaseURL}}evil。com'

    matchers:
      - type: regex
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?://|//)(?:[a-zA-Z0-9\-_\.@]*)evil\.com.*$'
        part: header

      - type: status
        status:
          - 301
          - 302
          - 303
          - 307
          - 308
